* Understanding Color Configuration

** The Three-Step Pipeline

#+begin_example
All Commits â†’ [Time Window] â†’ [Quality Control] â†’ [Color Scheme] â†’ Display
              recent-days      gradient-quality    color-scheme
#+end_example

** Step 1: Time Window (~blame-reveal-recent-days-limit~)

Decides *which* commits get gradient colors vs gray.

*** Options

| Setting | Behavior                           | Use Case                |
|---------+------------------------------------+-------------------------|
| ~'auto~   | Adapt to file activity             | Recommended             |
| ~90~      | Fixed 90 days                      | Predictable window      |
| ~nil~     | All commits (relative colors)      | Like IntelliJ IDEA      |

*** Visual

#+begin_example
'auto (adaptive):
  Now â—„â”€â”€â”€ calculated window â”€â”€â”€â–º â”‚ (old)
  C1   C2   C3   C4   C5          â”‚ C6  C7
  ğŸŸ¦   ğŸŸ¦   ğŸŸ¦   ğŸŸ¦   ğŸŸ¦          â¬œ  â¬œ

90 (fixed):
  Now â—„â”€â”€â”€â”€â”€â”€ 90 days â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º â”‚ (old)
  C1   C2   ...  C15             â”‚ C16  C17
  ğŸŸ¦   ğŸŸ¦   ğŸŸ¦   ğŸŸ¦              â¬œ  â¬œ

nil (all):
  Now â—„â”€â”€â”€â”€â”€â”€â”€â”€ all commits â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º
  C1   C2   ...  C50   ...  C200   ...  C500
  ğŸŸ¦   ğŸŸ¦   ğŸŸ¦   ğŸŸ¦   ğŸŸ¦   ğŸŸ¦   ğŸŸ¦   ğŸŸ¦
  bright â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º dim
#+end_example

** Step 2: Quality Control (~blame-reveal-gradient-quality~)

Only applies when ~recent-days-limit~ is ~'auto~. Controls trade-off between coverage and color distinction.

*** Settings

| Mode      | Commits | Color Step | Window  | Best For          |
|-----------+---------+------------+---------+-------------------|
| ~'strict~   | 5-10    | 3-5%       | ~30d    | Very active files |
| ~'auto~     | 10-20   | 2-3%       | ~90d    | Most files        |
| ~'relaxed~  | 15-30   | 1.5-2%     | ~180d   | Quiet files       |

*** Visual (Dark Theme)

#+begin_example
'strict (excellent distinction):
C1    C2    C3    C4    C5    C6    C7    C8
â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ â–ˆâ–ˆâ–ˆâ–ˆâ–“ â–ˆâ–ˆâ–ˆâ–“â–‘ â–ˆâ–ˆâ–“â–‘â–‘ â–ˆâ–“â–‘â–‘â–‘ â–“â–‘â–‘â–‘â–‘ â–‘â–‘â–‘â–‘â–‘ â–‘â–‘â–‘â–‘â–‘
70%   65%   60%   55%   50%   45%   40%   35%

'auto (balanced):
C1    C2    C3    ...  C12   C13   C14   C15
â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ â–ˆâ–ˆâ–ˆâ–ˆâ–“ â–ˆâ–ˆâ–ˆâ–“â–‘ â–‘â–‘â–‘  â–“â–‘â–‘â–‘  â–‘â–‘â–‘â–‘  â–‘â–‘â–‘â–‘  â–‘â–‘â–‘â–‘
70%   67%   64%   ...  43%   40%   37%   35%

'relaxed (maximum history):
C1    C2    ...  C15   ...  C25   C26   C27   C28
â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ â–ˆâ–ˆâ–ˆâ–ˆâ–“ â–‘â–‘â–‘  â–ˆâ–“â–‘â–‘  â–‘â–‘â–‘  â–“â–‘â–‘â–‘  â–‘â–‘â–‘â–‘  â–‘â–‘â–‘â–‘  â–‘â–‘â–‘â–‘
70%   68%   ...  55%   ...  40%   38%   36%   35%
#+end_example

*** The Algorithm

#+begin_src
1. Sample 5-15 most recent commits
2. Calculate time span (e.g., 30 days)
3. Extend by quality factor:
   strict:  Ã— 1.5 â†’ ~45 days
   auto:    Ã— 1.8 â†’ ~54 days
   relaxed: Ã— 2.5 â†’ ~75 days
4. Refine:
   - If too few commits â†’ expand
   - If colors too similar â†’ shrink
   - If wasting color range â†’ expand
5. Cache result (invalidates on commit count change)
#+end_src

** Step 3: Color Scheme (~blame-reveal-color-scheme~)

Controls *how* the gradient looks using HSL color space.

*** Why HSL?

- *Hue* (0-360Â°): Color family (210=blue, 120=green, 280=purple)
- *Saturation* (0.0-1.0): Intensity (0=gray, 1=vivid)
- *Lightness* (0.0-1.0): Brightness (dark theme: higher=brighter)

*** Parameters

| Parameter          | Controls                  | Dark    | Light   |
|--------------------+---------------------------+---------+---------|
| ~:hue~               | Color family              | 210     | same    |
| ~:dark-newest~       | Newest (bright)           | 0.70    | N/A     |
| ~:dark-oldest~       | Oldest (dark)             | 0.35    | N/A     |
| ~:light-newest~      | Newest (dark)             | N/A     | 0.45    |
| ~:light-oldest~      | Oldest (light)            | N/A     | 0.75    |
| ~:saturation-min~    | Oldest saturation         | 0.25    | same    |
| ~:saturation-max~    | Newest saturation         | 0.60    | same    |

*** Visual

#+begin_example
Default Blue (hue=210):
â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–“ â–ˆâ–ˆâ–ˆâ–ˆâ–“â–‘ â–ˆâ–ˆâ–ˆâ–“â–‘â–‘ â–ˆâ–ˆâ–“â–‘â–‘â–‘ â–ˆâ–“â–‘â–‘â–‘â–‘ â–“â–‘â–‘â–‘â–‘â–‘
L:70%  L:65%  L:60%  L:55%  L:50%  L:45%  L:40%
S:60%  S:55%  S:50%  S:45%  S:40%  S:35%  S:30%

Green (hue=120):
â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–“ â–ˆâ–ˆâ–ˆâ–ˆâ–“â–‘ â–ˆâ–ˆâ–ˆâ–“â–‘â–‘ â–ˆâ–ˆâ–“â–‘â–‘â–‘ â–ˆâ–“â–‘â–‘â–‘â–‘ â–“â–‘â–‘â–‘â–‘â–‘

High Contrast:
â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ â–ˆâ–ˆâ–ˆâ–ˆâ–“â–‘ â–ˆâ–ˆâ–“â–‘â–‘â–‘ â–“â–‘â–‘â–‘â–‘â–‘
L:75%  L:60%  L:45%  L:30%  (larger steps)
#+end_example

*** The Easing Function

The gradient uses ease-out-cubic for perceptually linear colors:

#+begin_example
f(x) = 1 - (1-x)Â³

Makes newer commits more distinct:
rank  linear  eased
0     0.00 â†’  0.00  (newest: brightest)
1     0.05 â†’  0.14  (big jump)
2     0.10 â†’  0.27
3     0.15 â†’  0.39
...
19    1.00 â†’  1.00  (oldest: dimmest)
#+end_example

** Configuration Recipes

#+begin_src elisp
;; 1. Smart defaults (recommended)
(setq blame-reveal-recent-days-limit 'auto
      blame-reveal-gradient-quality 'auto)

;; 2. Maximum clarity (very active files)
(setq blame-reveal-recent-days-limit 'auto
      blame-reveal-gradient-quality 'strict)

;; 3. Maximum history (exploration)
(setq blame-reveal-recent-days-limit 'auto
      blame-reveal-gradient-quality 'relaxed)

;; 4. Fixed window (predictable)
(setq blame-reveal-recent-days-limit 90)

;; 5. All commits (IntelliJ style)
(setq blame-reveal-recent-days-limit nil)

;; 6. Green high-contrast
(setq blame-reveal-color-scheme
      '(:hue 120
        :dark-newest 0.75 :dark-oldest 0.30
        :light-newest 0.35 :light-oldest 0.85
        :saturation-min 0.35 :saturation-max 0.70))
#+end_src

** By File Activity

#+begin_example
Very Active (200 commits/year):
  'auto + 'strict â†’ 30 days, 8 commits
  â–ˆâ–ˆâ–ˆâ–ˆ â–ˆâ–ˆâ–ˆâ–“ â–ˆâ–ˆâ–“â–‘ â–ˆâ–“â–‘â–‘ â–“â–‘â–‘â–‘ â–‘â–‘â–‘â–‘ â–‘â–‘â–‘â–‘ â–‘â–‘â–‘â–‘

Moderate (50 commits/year):
  'auto + 'auto â†’ 180 days, 12 commits
  â–ˆâ–ˆâ–ˆâ–ˆ â–ˆâ–ˆâ–ˆâ–“ â–ˆâ–ˆâ–“â–‘ â–ˆâ–“â–‘â–‘ â–“â–‘â–‘â–‘ ... â–‘â–‘â–‘â–‘

Quiet (10 commits/year):
  'auto + 'relaxed â†’ 365 days, 8 commits
  â–ˆâ–ˆâ–ˆâ–ˆ â–ˆâ–ˆâ–ˆâ–“ â–ˆâ–ˆâ–“â–‘ â–ˆâ–“â–‘â–‘ â–“â–‘â–‘â–‘ â–‘â–‘â–‘â–‘ â–‘â–‘â–‘â–‘ â–‘â–‘â–‘â–‘
#+end_example

** Common Mistake

#+begin_src elisp
;; âœ— WRONG: gradient-quality ignored with fixed days
(setq blame-reveal-gradient-quality 'strict    ; â† No effect!
      blame-reveal-recent-days-limit 30)       ; â† Only this used

;; âœ“ CORRECT: Choose one approach
(setq blame-reveal-recent-days-limit 'auto     ; Let auto calculate
      blame-reveal-gradient-quality 'strict)   ; With strict quality

;; OR
(setq blame-reveal-recent-days-limit 30)       ; Fixed 30 days
;; (gradient-quality not needed)
#+end_src

** Debugging

#+begin_src elisp
;; Show calculation details
M-x blame-reveal-show-auto-calculation

;; Output:
;; - Total commits: 156
;; - Sample size: 15 commits
;; - Sample span: 45.2 days
;; - Calculated limit: 90 days
;; - Commits in range: 18
;; - Quality: Good (2.47% per commit)

;; Force recalculation
M-x blame-reveal-clear-auto-cache
#+end_src

** Decision Tree

#+begin_example
What's your priority?
â”œâ”€ Simple & smart     â†’ 'auto + 'auto
â”œâ”€ Best distinction   â†’ 'auto + 'strict
â”œâ”€ More history       â†’ 'auto + 'relaxed or 180 (days)
â”œâ”€ All commits        â†’ nil
â””â”€ Custom colors      â†’ Modify :hue, :dark-newest, etc.
#+end_example

** Quick Reference

| Want               | Setting                                |
|--------------------+----------------------------------------|
| Smart defaults     | ~'auto + 'auto~                          |
| Best clarity       | ~'auto + 'strict~                        |
| More history       | ~'auto + 'relaxed~ or ~180~                |
| All commits        | ~nil~                                    |
| Green              | ~:hue 120~                               |
| High contrast      | ~:dark-newest 0.75 :dark-oldest 0.30~    |
| Debug              | ~M-x blame-reveal-show-auto-calculation~ |
